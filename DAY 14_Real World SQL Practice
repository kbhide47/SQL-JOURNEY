Table: employees
employees(
  emp_id,
  name,
  age,
  department,
  designation,
  salary,
  city
)

1. Highest paid employee in each department
SELECT department, name, salary
FROM employees e1
WHERE salary = (
    SELECT MAX(salary)
    FROM employees e2
    WHERE e1.department = e2.department
);
2. Average salary of each department
SELECT department, AVG(salary) AS avg_salary
FROM employees
GROUP BY department;
3. Employees earning more than department average
SELECT emp_id, name, department, salary
FROM employees e
WHERE salary > (
    SELECT AVG(salary)
    FROM employees
    WHERE department = e.department
);
4. Department with highest total salary
SELECT department, SUM(salary) AS total_salary
FROM employees
GROUP BY department
ORDER BY total_salary DESC
LIMIT 1;
5. Number of employees in each city
SELECT city, COUNT(*) AS total_employees
FROM employees
GROUP BY city;
6. Employees earning more than 50,000 in IT department
SELECT *
FROM employees
WHERE salary > 50000
AND department = 'IT';
7. Second highest salary
SELECT MAX(salary) AS second_highest_salary
FROM employees
WHERE salary < (SELECT MAX(salary) FROM employees);
8. Departments having more than one employee
SELECT department, COUNT(*) AS total_employees
FROM employees
GROUP BY department
HAVING COUNT(*) > 1;
9. Employees with salary between 40,000 and 60,000
SELECT *
FROM employees
WHERE salary BETWEEN 40000 AND 60000;
10. Cities where average salary is greater than 45,000
SELECT city, AVG(salary) AS avg_salary
FROM employees
GROUP BY city
HAVING AVG(salary) > 45000;

