-- Day 13: GROUP BY + HAVING (Mixed Practice)
-- Table used: employees(emp_id, name, age, department, designation, salary, city)

-- 1. Departments having average salary > 50,000 and more than 1 employee
SELECT department, AVG(salary) AS avg_salary, COUNT(*) AS total_employees
FROM employees
GROUP BY department
HAVING AVG(salary) > 50000 AND COUNT(*) > 1;

-- 2. Cities having total salary more than 80,000
SELECT city, SUM(salary) AS total_salary
FROM employees
GROUP BY city
HAVING SUM(salary) > 80000;

-- 3. Designations having maximum salary greater than 60,000
SELECT designation, MAX(salary) AS max_salary
FROM employees
GROUP BY designation
HAVING MAX(salary) > 60000;

-- 4. Departments having minimum salary < 40,000 and employee count > 1
SELECT department, MIN(salary) AS min_salary, COUNT(*) AS total_employees
FROM employees
GROUP BY department
HAVING MIN(salary) < 40000 AND COUNT(*) > 1;

-- 5. Cities having more than 1 employee and average salary < 50,000
SELECT city, COUNT(*) AS total_employees, AVG(salary) AS avg_salary
FROM employees
GROUP BY city
HAVING COUNT(*) > 1 AND AVG(salary) < 50000;

-- 6. Departments where total salary is between 80,000 and 1,50,000
SELECT department, SUM(salary) AS total_salary
FROM employees
GROUP BY department
HAVING SUM(salary) BETWEEN 80000 AND 150000;

-- 7. Designations having average salary greater than 45,000
SELECT designation, AVG(salary) AS avg_salary
FROM employees
GROUP BY designation
HAVING AVG(salary) > 45000;

-- 8. Cities having maximum salary greater than 50,000
SELECT city, MAX(salary) AS max_salary
FROM employees
GROUP BY city
HAVING MAX(salary) > 50000;

-- 9. Departments having employee count equal to 1
SELECT department, COUNT(*) AS total_employees
FROM employees
GROUP BY department
HAVING COUNT(*) = 1;

-- 10. Designations where total salary is greater than 70,000
SELECT designation, SUM(salary) AS total_salary
FROM employees
GROUP BY designation
HAVING SUM(salary) > 70000;
